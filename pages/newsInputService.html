<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratorium Business Analytics</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome untuk ikon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts - Nunito -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap"
        rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/newsInputServiceStyle.css">
</head>

<body>
    <!-- Sticky Navigation Bar -->
    <nav class="sticky-navbar">
        <div class="logo-container">
            <div class="logo">
                <img src="../assets/img/logo.png" alt="Laboratorium Business Analytics Logo">
            </div>
            <div class="lab-name-container">
                <div class="lab-name">Laboratorium Business Analytics</div>
                <div class="lab-tagline">Transforming Data into Decisions</div>
            </div>
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a class="nav-link" href="beranda.html">Beranda</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="profile.html">Profil</a>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle active" href="#">
                    Publikasi
                    <i class="fas fa-chevron-down dropdown-icon"></i>
                </a>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="berita.html">Berita</a></li>
                    <li><a class="dropdown-item" href="galeri.html">Gallery</a></li>
                    <li><a class="dropdown-item" href="newsInputService.html">News Input Service</a></li>
                </ul>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#">
                    Peminjaman Lab
                    <i class="fas fa-chevron-down dropdown-icon"></i>
                </a>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="infoPeminjaman.html">Informasi Laboratorium</a></li>
                    <li><a class="dropdown-item" href="tableBooking.html">Table Peminjaman</a></li>
                    <li><a class="dropdown-item" href="booking.html">Pemesanan Lab</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="kontak.html">Kontak</a>
            </li>
        </ul>

        <button class="login-btn">Login</button>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid news-input-container">
        <div class="row">
            <!-- Form Input Berita -->
            <div class="col-lg-8">
                <h1 class="news-input-title">News Input From Users</h1>
                <p class="news-input-subtitle">enter the following content :</p>

                <form id="newsForm">
                    <div class="mb-3">
                        <label for="name" class="form-label">Name</label>
                        <input type="text" class="form-control" id="name" placeholder="Masukkan nama Anda">
                    </div>

                    <div class="mb-3">
                        <label for="newsDate" class="form-label">Tanggal Berita</label>
                        <input type="date" class="form-control" id="newsDate">
                    </div>

                    <div class="mb-3">
                        <label for="status" class="form-label">Status/Kategori Pembhon</label>
                        <select class="form-select" id="status">
                            <option selected disabled>Pilih status/kategori</option>
                            <option value="dosen">Dosen</option>
                            <option value="mahasiswa">Mahasiswa</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="newsTitle" class="form-label">Judul Berita</label>
                        <input type="text" class="form-control" id="newsTitle" placeholder="Masukkan judul berita">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Masukkan Foto Berita</label>
                        <div class="file-upload-container" id="fileUploadContainer">
                            <!-- Placeholder untuk upload (ditampilkan saat tidak ada gambar) -->
                            <div id="uploadPlaceholder" class="file-upload-placeholder">
                                <i class="fas fa-cloud-upload-alt file-upload-icon"></i>
                                <p class="file-upload-text">Upload Foto Berita</p>
                                <p class="file-upload-subtext">Klik atau seret file ke sini (Bisa pilih beberapa gambar)
                                </p>
                            </div>

                            <!-- Container untuk preview gambar di dalam kotak yang sama -->
                            <div id="imagesPreviewContainer" class="images-preview-container" style="display: none;">
                            </div>

                            <!-- Info dan tombol aksi (ditampilkan saat ada gambar) -->
                            <div id="uploadInfo" class="upload-info" style="display: none;">
                                <div id="uploadedCount" class="uploaded-count"></div>
                                <div class="preview-actions">
                                    <button type="button" class="preview-btn" id="addMoreImagesBtn">
                                        <i class="fas fa-plus"></i> Tambah Gambar Lain
                                    </button>
                                    <button type="button" class="preview-btn remove" id="removeAllImagesBtn">
                                        <i class="fas fa-trash"></i> Hapus Semua
                                    </button>
                                </div>
                            </div>
                            <input type="file" class="file-input" id="newsPhoto" accept="image/*" multiple>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="newsDescription" class="form-label">Deskripsi Berita</label>
                        <textarea class="form-control" id="newsDescription" rows="5"
                            placeholder="Masukkan deskripsi berita"></textarea>
                    </div>

                    <button type="submit" class="confirm-btn">Confirm News</button>
                </form>
            </div>

            <!-- Rules Section -->
            <div class="col-lg-4">
                <div class="rules-container">
                    <h3 class="rules-title">Rules BLablabla</h3>
                    <p class="rules-content">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p>

                    <div class="rules-divider"></div>

                    <h3 class="rules-title">Rules BLablabla</h3>
                    <p class="rules-content">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JavaScript -->
    <script>
        // Perbaikan untuk navigasi section
        document.addEventListener('DOMContentLoaded', function () {
            const sectionLinks = document.querySelectorAll('.section-nav-link');

            sectionLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();

                    // Hapus kelas active dari semua link
                    sectionLinks.forEach(l => l.classList.remove('active'));

                    // Tambah kelas active ke link yang diklik
                    this.classList.add('active');

                    // Dapatkan target section
                    const targetId = this.getAttribute('href').substring(1);
                    const targetSection = document.getElementById(targetId);

                    if (targetSection) {
                        // Hitung offset dengan mempertimbangkan tinggi navbar
                        const navbarHeight = document.querySelector('.sticky-navbar').offsetHeight;
                        const sectionNavHeight = document.querySelector('.section-navbar').offsetHeight;
                        const offsetTop = targetSection.offsetTop - navbarHeight - sectionNavHeight;

                        // Scroll ke section
                        window.scrollTo({
                            top: Math.max(0, offsetTop),
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Update active section saat scroll
            window.addEventListener('scroll', function () {
                const sections = document.querySelectorAll('section[id], div[id]');
                const scrollPos = window.scrollY + 200; // Offset untuk menentukan section aktif

                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.offsetHeight;
                    const sectionId = section.getAttribute('id');

                    if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
                        sectionLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${sectionId}`) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            });
        });

        // Fallback untuk smooth scroll di browser lama
        if (!('scrollBehavior' in document.documentElement.style)) {
            document.querySelectorAll('.section-nav-link').forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetSection = document.getElementById(targetId);

                    if (targetSection) {
                        const navbar = document.querySelector('.sticky-navbar');
                        const sectionNav = document.querySelector('.section-navbar');
                        const offsetTop = targetSection.offsetTop -
                            (navbar ? navbar.offsetHeight : 0) -
                            (sectionNav ? sectionNav.offsetHeight : 0) - 10;

                        window.scrollTo(0, Math.max(0, offsetTop));
                    }
                });
            });
        }

        // Scroll Behavior untuk Navbar
        class NavbarScrollBehavior {
            constructor() {
                this.mainNavbar = document.getElementById('mainNavbar');
                this.sectionNavbar = document.getElementById('sectionNavbar');
                this.lastScrollY = window.scrollY;
                this.scrollThreshold = 100; // Scroll berapa pixel sebelum navbar utama hilang
                this.isMainNavHidden = false;

                this.init();
            }

            init() {
                window.addEventListener('scroll', () => {
                    this.handleScroll();
                });

                // Initial check
                this.handleScroll();
            }

            handleScroll() {
                const currentScrollY = window.scrollY;
                const scrollDirection = currentScrollY > this.lastScrollY ? 'down' : 'up';

                // Jika scroll ke bawah melebihi threshold, sembunyikan navbar utama
                if (scrollDirection === 'down' && currentScrollY > this.scrollThreshold && !this.isMainNavHidden) {
                    this.hideMainNavbar();
                }
                // Jika scroll ke atas, tampilkan navbar utama
                else if (scrollDirection === 'up' && this.isMainNavHidden) {
                    this.showMainNavbar();
                }
                // Jika di paling atas, pastikan navbar utama visible
                else if (currentScrollY <= this.scrollThreshold && this.isMainNavHidden) {
                    this.showMainNavbar();
                }

                this.lastScrollY = currentScrollY;
            }

            hideMainNavbar() {
                this.mainNavbar.classList.add('hidden');
                this.sectionNavbar.classList.add('main-sticky');
                document.body.classList.add('nav-main-hidden');
                this.isMainNavHidden = true;
            }

            showMainNavbar() {
                this.mainNavbar.classList.remove('hidden');
                this.sectionNavbar.classList.remove('main-sticky');
                document.body.classList.remove('nav-main-hidden');
                this.isMainNavHidden = false;
            }
        }

        // Compact navbar saat scroll
        class CompactNavbar {
            constructor() {
                this.mainNavbar = document.getElementById('mainNavbar');
                this.compactThreshold = 50;

                this.init();
            }

            init() {
                window.addEventListener('scroll', () => {
                    this.toggleCompact();
                });
            }

            toggleCompact() {
                if (window.scrollY > this.compactThreshold) {
                    this.mainNavbar.classList.add('compact');
                } else {
                    this.mainNavbar.classList.remove('compact');
                }
            }
        }

        // Initialize semua behavior ketika DOM ready
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize scroll behavior
            new NavbarScrollBehavior();
            new CompactNavbar();

            // Initialize roadmap carousel jika ada
            const roadmapCards = document.querySelectorAll('.roadmap-card');
            if (roadmapCards.length > 0) {
                new RoadmapCarousel();
            }

            // Initialize section navigation
            new SectionNavigation();
        });

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new RoadmapCarousel();
            new SectionNavigation();
        });

        // Initialize section navigation when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new RoadmapCarousel();
            new SectionNavigation();
        });

        // File upload functionality dengan multiple images
        const fileUploadContainer = document.getElementById('fileUploadContainer');
        const uploadPlaceholder = document.getElementById('uploadPlaceholder');
        const fileInput = document.getElementById('newsPhoto');
        const imagesPreviewContainer = document.getElementById('imagesPreviewContainer');
        const uploadInfo = document.getElementById('uploadInfo');
        const uploadedCount = document.getElementById('uploadedCount');
        const addMoreImagesBtn = document.getElementById('addMoreImagesBtn');
        const removeAllImagesBtn = document.getElementById('removeAllImagesBtn');

        // Array untuk menyimpan gambar yang diupload
        let uploadedImages = [];

        // Fungsi untuk menampilkan preview gambar
        function showImagePreviews(files) {
            // Validasi jumlah file
            if (uploadedImages.length + files.length > 10) {
                alert('Maksimal 10 gambar yang dapat diupload');
                return;
            }

            for (let i = 0; i < files.length; i++) {
                const file = files[i];

                // Validasi tipe file
                if (!file.type.startsWith('image/')) {
                    alert(`File "${file.name}" bukan gambar. Silakan pilih file gambar.`);
                    continue;
                }

                const reader = new FileReader();

                reader.onload = function (e) {
                    // Simpan data gambar
                    const imageData = {
                        id: Date.now() + i,
                        src: e.target.result,
                        file: file
                    };

                    uploadedImages.push(imageData);

                    // Buat elemen preview
                    const previewItem = document.createElement('div');
                    previewItem.className = 'image-preview-item';
                    previewItem.setAttribute('data-id', imageData.id);

                    previewItem.innerHTML = `
                            <img src="${imageData.src}" class="image-preview" alt="Preview">
                            <button type="button" class="image-remove-btn" data-id="${imageData.id}">
                                <i class="fas fa-times"></i>
                            </button>
                        `;

                    imagesPreviewContainer.appendChild(previewItem);

                    // Update UI
                    updatePreviewUI();
                }

                reader.readAsDataURL(file);
            }
        }

        // Fungsi untuk update UI setelah perubahan
        function updatePreviewUI() {
            if (uploadedImages.length > 0) {
                // Tampilkan container preview dan info
                imagesPreviewContainer.style.display = 'grid';
                uploadInfo.style.display = 'flex';
                uploadPlaceholder.style.display = 'none';

                // Update counter
                uploadedCount.textContent = `${uploadedImages.length} gambar terupload`;
            } else {
                // Sembunyikan container preview dan info
                imagesPreviewContainer.style.display = 'none';
                uploadInfo.style.display = 'none';
                uploadPlaceholder.style.display = 'flex';
            }
        }

        // Event untuk klik pada container upload
        fileUploadContainer.addEventListener('click', function (e) {
            // Jangan trigger jika klik pada tombol aksi preview atau gambar
            if (!e.target.closest('.preview-btn') && !e.target.closest('.image-preview-item')) {
                fileInput.click();
            }
        });

        // Event untuk perubahan file input
        fileInput.addEventListener('change', function () {
            if (this.files && this.files.length > 0) {
                showImagePreviews(Array.from(this.files));
                this.value = ''; // Reset input untuk memungkinkan pemilihan file yang sama lagi
            }
        });

        // Event untuk drag & drop
        fileUploadContainer.addEventListener('dragover', function (e) {
            e.preventDefault();
            this.style.borderColor = '#2b95fd';
            this.style.backgroundColor = 'rgba(43, 149, 253, 0.1)';
        });

        fileUploadContainer.addEventListener('dragleave', function () {
            this.style.borderColor = '#ddd';
            this.style.backgroundColor = '';
        });

        fileUploadContainer.addEventListener('drop', function (e) {
            e.preventDefault();
            this.style.borderColor = '#ddd';
            this.style.backgroundColor = '';

            if (e.dataTransfer.files.length) {
                showImagePreviews(Array.from(e.dataTransfer.files));
            }
        });

        // Event untuk tombol hapus gambar individual (delegasi event)
        imagesPreviewContainer.addEventListener('click', function (e) {
            if (e.target.closest('.image-remove-btn')) {
                const removeBtn = e.target.closest('.image-remove-btn');
                const imageId = parseInt(removeBtn.getAttribute('data-id'));

                // Hapus gambar dari array
                uploadedImages = uploadedImages.filter(img => img.id !== imageId);

                // Hapus elemen preview
                const previewItem = document.querySelector(`.image-preview-item[data-id="${imageId}"]`);
                if (previewItem) {
                    previewItem.remove();
                }

                // Update UI
                updatePreviewUI();
            }
        });

        // Event untuk tombol tambah gambar lain
        addMoreImagesBtn.addEventListener('click', function () {
            fileInput.click();
        });

        // Event untuk tombol hapus semua gambar
        removeAllImagesBtn.addEventListener('click', function () {
            if (confirm('Apakah Anda yakin ingin menghapus semua gambar?')) {
                // Hapus semua gambar
                uploadedImages = [];
                imagesPreviewContainer.innerHTML = '';

                // Update UI
                updatePreviewUI();
            }
        });

        // Event untuk form submission
        document.getElementById('newsForm').addEventListener('submit', function (e) {
            e.preventDefault();

            // Validasi form
            if (uploadedImages.length === 0) {
                alert('Silakan upload minimal satu gambar untuk berita');
                return;
            }

            // Simulasi pengiriman data
            alert(`Berita berhasil dikirim dengan ${uploadedImages.length} gambar!`);

            // Reset form
            this.reset();
            uploadedImages = [];
            imagesPreviewContainer.innerHTML = '';
            updatePreviewUI();
        });
    </script>
</body>

</html>